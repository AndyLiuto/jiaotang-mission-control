<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <title>ç„¦ç³– Mission Control</title>
    <script>
        const AUTH_CODE = "COOCaramel";
        function checkAuth() {
            const saved = localStorage.getItem("jiaotang_auth");
            if (saved === AUTH_CODE) return;
            const input = prompt("è¯·è¾“å…¥ç„¦ç³–æˆæƒç  (ğŸ®):");
            if (input === AUTH_CODE) {
                localStorage.setItem("jiaotang_auth", AUTH_CODE);
            } else {
                document.body.innerHTML = "<h1 style='padding:50px;text-align:center;'>ğŸ”’ è®¿é—®è¢«æ‹’ç»ã€‚è¯·å‘ç„¦ç³–è·å–æˆæƒç ã€‚</h1>";
                window.stop();
            }
        }
        checkAuth();
    </script>
    <style>
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f4f7f6; color: #333; margin: 0; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .card { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid #eef2f1; }
        h1 { color: #d97706; margin-bottom: 30px; font-size: 24px; }
        h2 { font-size: 18px; border-bottom: 2px solid #f4f7f6; padding-bottom: 10px; margin-top: 0; color: #1f2937; }
        .status { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; }
        .status-live { background: #fee2e2; color: #991b1b; animation: blink 1s infinite; }
        .status-upcoming { background: #dbeafe; color: #1e40af; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
        .section-sub { font-size: 14px; font-weight: bold; color: #9a3412; margin: 15px 0 10px 0; }
        .footer { text-align: center; margin-top: 40px; color: #9ca3af; font-size: 12px; }
        .team-logo { font-size: 20px; margin-right: 8px; }
        .match-row { display: flex; align-items: center; justify-content: space-between; padding: 8px 0; border-bottom: 1px dashed #e5e7eb; }
        .match-opponent { font-weight: 500; }
        .match-date { font-size: 12px; color: #6b7280; }
        .task-item { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #f9fafb; }
        .task-title { font-weight: 600; display: block; margin-bottom: 4px; }
        .task-meta { font-size: 12px; color: #6b7280; }
        .summary-box { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 20px; border-radius: 12px; text-align: center; }
        .summary-box.profit { background: linear-gradient(135deg, #fecaca 0%, #fca5a5 100%); }
        .summary-box.loss { background: linear-gradient(135deg, #bbf7d0 0%, #86efac 100%); }
        .summary-value { font-size: 32px; font-weight: bold; color: #1f2937; }
        .summary-label { font-size: 12px; color: #6b7280; margin-top: 5px; }
        .link-btn { display: inline-block; background: #d97706; color: white; padding: 8px 16px; border-radius: 8px; text-decoration: none; font-size: 14px; margin-top: 15px; }
        .link-btn:hover { background: #b45309; }
    </style>
</head>
<body>
    <h1>ğŸ® ç„¦ç³– Mission Control</h1>

    <div class="grid">
        <!-- æŒä»“æ‘˜è¦ -->
        <div class="card" style="border-left: 4px solid #ef4444;">
            <h2>ğŸ’° æŒä»“æ‘˜è¦</h2>
            <div class="summary-box" id="summaryBox">
                <div class="summary-value" id="totalPnL">åŠ è½½ä¸­...</div>
                <div class="summary-label">æ€»ç›ˆäº | 4 åªæŒä»“</div>
            </div>
            <div style="text-align: center;">
                <a href="https://7a2a02e3b620.ngrok-free.app" class="link-btn" target="_blank">ğŸ“Š æŸ¥çœ‹å®Œæ•´æŒä»“</a>
            </div>
        </div>

        <!-- ä½“è‚²ä¸­å¿ƒ -->
        <div class="card" style="border-left: 4px solid #ef4444;">
            <h2>ğŸ† ä½“è‚²ä¸­å¿ƒ</h2>
            
            <div class="section-sub"><span class="team-logo">ğŸ”´</span> é˜¿æ£®çº³</div>
            <div class="match-row">
                <div><span class="match-opponent">vs æ¡‘å¾·å…° (Sunderland)</span><div class="match-date">âœ… 3-0 å¤§èƒœ (Emirates)</div></div>
                <span class="status status-live">å®Œèµ›</span>
            </div>
            <div class="task-meta">âš½ï¸ è¿›çƒ: ç¥–æ¯”é—¨è¿ª (42'), çº¦å…‹é›·æ–¯ x2 (66', 90'+3)</div>
            <div class="task-meta">ğŸ† ç§¯åˆ†æ¦œ: é¢†å…ˆä¼˜åŠ¿æ‰©å¤§è‡³ 9 åˆ†</div>

            <div class="section-sub"><span class="team-logo">ğŸ”¥</span> å¼€æ‹“è€… (æ¨æ±‰æ£®)</div>
            <div class="match-row">
                <div><span class="match-opponent">vs ç°ç†Š (G1)</span><div class="match-date">âœ… 135-115 å¤§èƒœ!</div></div>
                <span class="status status-live">å®Œèµ›</span>
            </div>
            <div class="match-row" style="border-top: 1px dashed #e5e7eb;">
                <div><span class="match-opponent">vs ç°ç†Š (G2)</span><div class="match-date">Feb 8 (Sun) 14:00 åŒ—äº¬</div></div>
                <span class="status status-upcoming">å³å°†</span>
            </div>

            <div class="section-sub"><span class="team-logo">âš”ï¸</span> XG Xtreme Gaming</div>
            <div class="match-row">
                <div><span class="match-opponent">BLAST Slam VI (Play-In)</span><div class="match-date">ä¸æ•Œ Falcons, é—æ†¾å‡ºå±€</div></div>
                <span class="status status-live">å®Œèµ›</span>
            </div>
            <div class="task-meta">âŒ Play-In é˜¶æ®µ: 0-2 è´Ÿäº Team Falcons</div>
            <div class="task-meta">âœ… æ­¤å‰å°ç»„èµ›: 5èƒœ 5è´Ÿ (èƒœ: Spirit, OG, Heroic, GL, REKONIX)</div>
            <div class="section-sub" style="font-size: 12px; color: #ff9800;">ğŸ”œ ä¸‹ä¸€èµ›äº‹: ç­‰å¾…å®˜æ–¹å…¬å¸ƒ</div>
        </div>

        <!-- é«˜é¢‘ç›‘æ§ -->
        <div class="card" style="border-left: 4px solid #3b82f6;">
            <h2>ğŸ“‰ é«˜é¢‘ç›‘æ§ (2026-02-09 ç›˜ä¸­)</h2>
            <div class="match-row">
                <div><span class="match-opponent">æ²ªæ·±300ETF (510300)</span></div>
                <div style="text-align: right;">
                    <div style="font-weight:bold;">4.695</div>
                    <div style="font-size:12px; color:#ef4444;">+0.99%</div>
                </div>
            </div>
            <div class="match-row">
                <div><span class="match-opponent">éš†åŸºç»¿èƒ½ (601012)</span></div>
                <div style="text-align: right;">
                    <div style="font-weight:bold;">18.75</div>
                    <div style="font-size:12px; color:#ef4444;">+2.12%</div>
                </div>
            </div>
            <div class="match-row">
                <div><span class="match-opponent">ä¸­å›½ä¸œèˆª (600115)</span></div>
                <div style="text-align: right;">
                    <div style="font-weight:bold;">6.31</div>
                    <div style="font-size:12px; color:#ef4444;">+0.16%</div>
                </div>
            </div>
             <div class="task-meta" style="margin-top:10px;">æ›´æ–°æ—¶é—´: 09:30 (2026-02-09 Aè‚¡ç›˜ä¸­)</div>
        </div>

        <!-- ç³»ç»ŸçŠ¶æ€ -->
        <div class="card" style="border-left: 4px solid #10b981;">
            <h2>ğŸ› ï¸ ç³»ç»ŸçŠ¶æ€</h2>
            <div class="task-item">
                <span class="task-title">âœ… è‚¡ç¥¨è¿½è¸ªå™¨</span>
                <div class="task-meta">http://aiserver:3456 è¿è¡Œä¸­</div>
            </div>
            <div class="task-item">
                <span class="task-title">âœ… å°çº¢ä¹¦ MCP</span>
                <div class="task-meta" id="xhsStatus">Session æ­£å¸¸ (å·²ä¸Šçº¿)</div>
            </div>
            <div class="task-item">
                <span class="task-title">âœ… RSSHub</span>
                <div class="task-meta">Twitter æŠ“å–å·²ä¿®å¤</div>
            </div>
        </div>
    </div>

    <div class="footer">
        ç„¦ç³–ä¸ºä½ å·¡èˆª ğŸ®
    </div>

    <script>
        // ä»è‚¡ç¥¨è¿½è¸ªå™¨ API è·å–æ‘˜è¦
        async function fetchSummary() {
            try {
                const res = await fetch('/api/holdings');
                const data = await res.json();
                const { summary } = data;
                
                const pnlSign = summary.totalPnL >= 0 ? '+' : '';
                const todaySign = summary.totalPnLToday >= 0 ? '+' : '';
                
                document.getElementById('totalPnL').innerHTML = `
                    <div style="font-size: 24px;">ç´¯è®¡ ${pnlSign}Â¥${summary.totalPnL.toFixed(0)}</div>
                    <div style="font-size: 18px; margin-top: 5px; color: ${summary.totalPnLToday >= 0 ? '#ef4444' : '#22c55e'}">
                        ä»Šæ—¥ ${todaySign}Â¥${summary.totalPnLToday.toFixed(0)}
                    </div>
                `;
                
                const box = document.getElementById('summaryBox');
                box.classList.remove('profit', 'loss');
                box.classList.add(summary.totalPnL >= 0 ? 'profit' : 'loss');
            } catch (e) {
                document.getElementById('totalPnL').textContent = 'æ— æ³•è¿æ¥';
            }
        }
        
        fetchSummary();
        setInterval(fetchSummary, 60000);
    </script>
</body>
</html>